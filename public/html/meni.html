<!DOCTYPE html>
<html lang = "hr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width">
        <link rel="stylesheet" type="text/css" href="../css/meni.css">
        <title>Meni</title>
       
    </head>
    <body>
        <div id="meni">
            <ul>
                <li> <a href="profil.html" target="_parent">Profil</a></li>
                <li> <a href="nekretnine.html" target="_parent">Nekretnine</a></li>
                <li> <a href="detalji.html" target="_parent">Detalji</a></li>
                <li id="prijava-opcija"> <a href="prijava.html" target="_parent">Prijava</a></li>
                <li id="odjava-opcija"> <a href="prijava.html" onclick="odjava(); return false;" target="_parent">Odjava</a></li>
            </ul>
        </div>
    </body>
</html>

<script>
    /* function proveriPrijavu() {
        let ajax = new XMLHttpRequest();
        ajax.onreadystatechange = function() {
            if (ajax.readyState == 4 && ajax.status == 200) {
                let odgovor = JSON.parse(ajax.responseText);
                if (odgovor.prijavljen) {
                    document.getElementById('prijava-opcija').style.display = 'none';
                    document.getElementById('odjava-opcija').style.display = 'inline-block'; 
                } else {
                    document.getElementById('prijava-opcija').style.display = 'inline-block';
                    document.getElementById('odjava-opcija').style.display = 'none';
                }
            }
        }
    }
    function odjava() {
        let ajax = new XMLHttpRequest();
        ajax.onreadystatechange = function() {
            if (ajax.readyState == 4 && ajax.status == 200) {
                let odgovor = JSON.parse(ajax.responseText);
                if (odgovor.poruka) {
                    document.getElementById('prijava-opcija').style.display = 'inline-block';
                    document.getElementById('odjava-opcija').style.display = 'none';
                    alert(odgovor.poruka);  
                }
                else {
                    alert('Odjava nije uspjela!');
                }
            }
        }
    }*/
    function provjeriPrijavu() {
        fetch('/provjeriPrijavu')
        .then(response => response.json())
        .then(data => {
            if (data.prijavljen) {
                document.getElementById('odjava-opcija').style.display = 'inline-block'; 
                document.getElementById('prijava-opcija').style.display = 'none';
            } else {
                document.getElementById('odjava-opcija').style.display = 'none';
                document.getElementById('prijava-opcija').style.display = 'inline-block';
            }
        });
    }
    function odjava() {
        fetch('/logout', {
            method: 'POST',
            headers: {
                        'Content-Type': 'application/json'
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.poruka) {
                document.getElementById('prijava-opcija').style.display = 'inline-block';
                document.getElementById('odjava-opcija').style.display = 'none';
                alert(data.poruka);  
            }
            else {
                alert('Odjava nije uspjela!');
            }
        });
    }
    window.onload = provjeriPrijavu;
</script>